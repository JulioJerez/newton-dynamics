/* Copyright (c) <2003-2022> <Julio Jerez, Newton Game Dynamics>
*
* This software is provided 'as-is', without any express or implied
* warranty. In no event will the authors be held liable for any damages
* arising from the use of this software.
*
* Permission is granted to anyone to use this software for any purpose,
* including commercial applications, and to alter it and redistribute it
* freely, subject to the following restrictions:
*
* 1. The origin of this software must not be misrepresented; you must not
* claim that you wrote the original software. If you use this software
* in a product, an acknowledgment in the product documentation would be
* appreciated but is not required.
*
* 2. Altered source versions must be plainly marked as such, and must not be
* misrepresented as being the original software.
*
* 3. This notice may not be removed or altered from any source distribution.
*/

#include "ndCoreStdafx.h"
#include "ndSort.h"
#include "ndDebug.h"
#include "ndVector.h"
#include "ndMatrix.h"
#include "ndProfiler.h"
#include "ndMarchingCubes.h"

// adapted from code by written by Paul Bourke may 1994
//http://paulbourke.net/geometry/polygonise/

#if 0
namespace Original
{
	struct XYZ
	{
		ndFloat32 x;
		ndFloat32 y;
		ndFloat32 z;
	};

	struct TRIANGLE
	{
		XYZ p[3];
	};

	struct GRIDCELL
	{
		XYZ p[8];
		ndFloat32 val[8];
	} ;
	#define ABS ndAbs

	/*
	   Linearly interpolate the position where an isosurface cuts
	   an edge between two vertices, each with their own scalar value
	*/

	//class mpVector : public ndVector
	//{
	//	bool operator<(const ndVector& right) const
	//	{
	//		if (x < right.x)
	//			return true;
	//		else if (x > right.x)
	//			return false;
	//
	//		if (y < right.y)
	//			return true;
	//		else if (y > right.y)
	//			return false;
	//
	//		if (z < right.z)
	//			return true;
	//		else if (z > right.z)
	//			return false;
	//
	//		return false;
	//	}
	//};
	//
	//ndVector LinearInterp(ndVector p1, ndVector p2, float value)
	//{
	//	if (p2 < p1)
	//	{
	//		ndVector temp;
	//		temp = p1;
	//		p1 = p2;
	//		p2 = temp;
	//	}
	//
	//	mpVector p;
	//	if (fabs(p1.val - p2.val) > 0.00001)
	//		p = (mpVector)p1 + ((mpVector)p2 - (mpVector)p1) / (p2.val - p1.val) * (value - p1.val);
	//	else
	//		p = (mpVector)p1;
	//	return p;
	//}

	XYZ VertexInterp(ndFloat32 isolevel, XYZ p1, XYZ p2, ndFloat32 valp1, ndFloat32 valp2)
	{
		ndFloat32 mu;
		XYZ p;

		if (ABS(isolevel - valp1) < 0.00001)
			return(p1);
		if (ABS(isolevel - valp2) < 0.00001)
			return(p2);
		if (ABS(valp1 - valp2) < 0.00001)
			return(p1);
		mu = (isolevel - valp1) / (valp2 - valp1);
		p.x = p1.x + mu * (p2.x - p1.x);
		p.y = p1.y + mu * (p2.y - p1.y);
		p.z = p1.z + mu * (p2.z - p1.z);

		return(p);
	}


	/*
	   Given a grid cell and an isolevel, calculate the triangular
	   facets required to represent the isosurface through the cell.
	   Return the number of triangular facets, the array "triangles"
	   will be loaded up with the vertices at most 5 triangular facets.
		0 will be returned if the grid cell is either totally above
	   of totally below the isolevel.
	*/
	int Polygonise(GRIDCELL grid, ndFloat32 isolevel, TRIANGLE* triangles)
	{
		int i, ntriang;
		int cubeindex;
		XYZ vertlist[12];

		static int edgeTable[256] = 
		{
			0x0  , 0x109, 0x203, 0x30a, 0x406, 0x50f, 0x605, 0x70c,
			0x80c, 0x905, 0xa0f, 0xb06, 0xc0a, 0xd03, 0xe09, 0xf00,
			0x190, 0x99 , 0x393, 0x29a, 0x596, 0x49f, 0x795, 0x69c,
			0x99c, 0x895, 0xb9f, 0xa96, 0xd9a, 0xc93, 0xf99, 0xe90,
			0x230, 0x339, 0x33 , 0x13a, 0x636, 0x73f, 0x435, 0x53c,
			0xa3c, 0xb35, 0x83f, 0x936, 0xe3a, 0xf33, 0xc39, 0xd30,
			0x3a0, 0x2a9, 0x1a3, 0xaa , 0x7a6, 0x6af, 0x5a5, 0x4ac,
			0xbac, 0xaa5, 0x9af, 0x8a6, 0xfaa, 0xea3, 0xda9, 0xca0,
			0x460, 0x569, 0x663, 0x76a, 0x66 , 0x16f, 0x265, 0x36c,
			0xc6c, 0xd65, 0xe6f, 0xf66, 0x86a, 0x963, 0xa69, 0xb60,
			0x5f0, 0x4f9, 0x7f3, 0x6fa, 0x1f6, 0xff , 0x3f5, 0x2fc,
			0xdfc, 0xcf5, 0xfff, 0xef6, 0x9fa, 0x8f3, 0xbf9, 0xaf0,
			0x650, 0x759, 0x453, 0x55a, 0x256, 0x35f, 0x55 , 0x15c,
			0xe5c, 0xf55, 0xc5f, 0xd56, 0xa5a, 0xb53, 0x859, 0x950,
			0x7c0, 0x6c9, 0x5c3, 0x4ca, 0x3c6, 0x2cf, 0x1c5, 0xcc ,
			0xfcc, 0xec5, 0xdcf, 0xcc6, 0xbca, 0xac3, 0x9c9, 0x8c0,
			0x8c0, 0x9c9, 0xac3, 0xbca, 0xcc6, 0xdcf, 0xec5, 0xfcc,
			0xcc , 0x1c5, 0x2cf, 0x3c6, 0x4ca, 0x5c3, 0x6c9, 0x7c0,
			0x950, 0x859, 0xb53, 0xa5a, 0xd56, 0xc5f, 0xf55, 0xe5c,
			0x15c, 0x55 , 0x35f, 0x256, 0x55a, 0x453, 0x759, 0x650,
			0xaf0, 0xbf9, 0x8f3, 0x9fa, 0xef6, 0xfff, 0xcf5, 0xdfc,
			0x2fc, 0x3f5, 0xff , 0x1f6, 0x6fa, 0x7f3, 0x4f9, 0x5f0,
			0xb60, 0xa69, 0x963, 0x86a, 0xf66, 0xe6f, 0xd65, 0xc6c,
			0x36c, 0x265, 0x16f, 0x66 , 0x76a, 0x663, 0x569, 0x460,
			0xca0, 0xda9, 0xea3, 0xfaa, 0x8a6, 0x9af, 0xaa5, 0xbac,
			0x4ac, 0x5a5, 0x6af, 0x7a6, 0xaa , 0x1a3, 0x2a9, 0x3a0,
			0xd30, 0xc39, 0xf33, 0xe3a, 0x936, 0x83f, 0xb35, 0xa3c,
			0x53c, 0x435, 0x73f, 0x636, 0x13a, 0x33 , 0x339, 0x230,
			0xe90, 0xf99, 0xc93, 0xd9a, 0xa96, 0xb9f, 0x895, 0x99c,
			0x69c, 0x795, 0x49f, 0x596, 0x29a, 0x393, 0x99 , 0x190,
			0xf00, 0xe09, 0xd03, 0xc0a, 0xb06, 0xa0f, 0x905, 0x80c,
			0x70c, 0x605, 0x50f, 0x406, 0x30a, 0x203, 0x109, 0x0 
		};

		static int triTable[256][16] =
		{ 
			{-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 1, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 8, 3, 9, 8, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 3, 1, 2, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{9, 2, 10, 0, 2, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{2, 8, 3, 2, 10, 8, 10, 9, 8, -1, -1, -1, -1, -1, -1, -1},
			{3, 11, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 11, 2, 8, 11, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 9, 0, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 11, 2, 1, 9, 11, 9, 8, 11, -1, -1, -1, -1, -1, -1, -1},
			{3, 10, 1, 11, 10, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 10, 1, 0, 8, 10, 8, 11, 10, -1, -1, -1, -1, -1, -1, -1},
			{3, 9, 0, 3, 11, 9, 11, 10, 9, -1, -1, -1, -1, -1, -1, -1},
			{9, 8, 10, 10, 8, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 7, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 3, 0, 7, 3, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 1, 9, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 1, 9, 4, 7, 1, 7, 3, 1, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 10, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{3, 4, 7, 3, 0, 4, 1, 2, 10, -1, -1, -1, -1, -1, -1, -1},
			{9, 2, 10, 9, 0, 2, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1},
			{2, 10, 9, 2, 9, 7, 2, 7, 3, 7, 9, 4, -1, -1, -1, -1},
			{8, 4, 7, 3, 11, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{11, 4, 7, 11, 2, 4, 2, 0, 4, -1, -1, -1, -1, -1, -1, -1},
			{9, 0, 1, 8, 4, 7, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1},
			{4, 7, 11, 9, 4, 11, 9, 11, 2, 9, 2, 1, -1, -1, -1, -1},
			{3, 10, 1, 3, 11, 10, 7, 8, 4, -1, -1, -1, -1, -1, -1, -1},
			{1, 11, 10, 1, 4, 11, 1, 0, 4, 7, 11, 4, -1, -1, -1, -1},
			{4, 7, 8, 9, 0, 11, 9, 11, 10, 11, 0, 3, -1, -1, -1, -1},
			{4, 7, 11, 4, 11, 9, 9, 11, 10, -1, -1, -1, -1, -1, -1, -1},
			{9, 5, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{9, 5, 4, 0, 8, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 5, 4, 1, 5, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{8, 5, 4, 8, 3, 5, 3, 1, 5, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 10, 9, 5, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{3, 0, 8, 1, 2, 10, 4, 9, 5, -1, -1, -1, -1, -1, -1, -1},
			{5, 2, 10, 5, 4, 2, 4, 0, 2, -1, -1, -1, -1, -1, -1, -1},
			{2, 10, 5, 3, 2, 5, 3, 5, 4, 3, 4, 8, -1, -1, -1, -1},
			{9, 5, 4, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 11, 2, 0, 8, 11, 4, 9, 5, -1, -1, -1, -1, -1, -1, -1},
			{0, 5, 4, 0, 1, 5, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1},
			{2, 1, 5, 2, 5, 8, 2, 8, 11, 4, 8, 5, -1, -1, -1, -1},
			{10, 3, 11, 10, 1, 3, 9, 5, 4, -1, -1, -1, -1, -1, -1, -1},
			{4, 9, 5, 0, 8, 1, 8, 10, 1, 8, 11, 10, -1, -1, -1, -1},
			{5, 4, 0, 5, 0, 11, 5, 11, 10, 11, 0, 3, -1, -1, -1, -1},
			{5, 4, 8, 5, 8, 10, 10, 8, 11, -1, -1, -1, -1, -1, -1, -1},
			{9, 7, 8, 5, 7, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{9, 3, 0, 9, 5, 3, 5, 7, 3, -1, -1, -1, -1, -1, -1, -1},
			{0, 7, 8, 0, 1, 7, 1, 5, 7, -1, -1, -1, -1, -1, -1, -1},
			{1, 5, 3, 3, 5, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{9, 7, 8, 9, 5, 7, 10, 1, 2, -1, -1, -1, -1, -1, -1, -1},
			{10, 1, 2, 9, 5, 0, 5, 3, 0, 5, 7, 3, -1, -1, -1, -1},
			{8, 0, 2, 8, 2, 5, 8, 5, 7, 10, 5, 2, -1, -1, -1, -1},
			{2, 10, 5, 2, 5, 3, 3, 5, 7, -1, -1, -1, -1, -1, -1, -1},
			{7, 9, 5, 7, 8, 9, 3, 11, 2, -1, -1, -1, -1, -1, -1, -1},
			{9, 5, 7, 9, 7, 2, 9, 2, 0, 2, 7, 11, -1, -1, -1, -1},
			{2, 3, 11, 0, 1, 8, 1, 7, 8, 1, 5, 7, -1, -1, -1, -1},
			{11, 2, 1, 11, 1, 7, 7, 1, 5, -1, -1, -1, -1, -1, -1, -1},
			{9, 5, 8, 8, 5, 7, 10, 1, 3, 10, 3, 11, -1, -1, -1, -1},
			{5, 7, 0, 5, 0, 9, 7, 11, 0, 1, 0, 10, 11, 10, 0, -1},
			{11, 10, 0, 11, 0, 3, 10, 5, 0, 8, 0, 7, 5, 7, 0, -1},
			{11, 10, 5, 7, 11, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{10, 6, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 3, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{9, 0, 1, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 8, 3, 1, 9, 8, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1},
			{1, 6, 5, 2, 6, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 6, 5, 1, 2, 6, 3, 0, 8, -1, -1, -1, -1, -1, -1, -1},
			{9, 6, 5, 9, 0, 6, 0, 2, 6, -1, -1, -1, -1, -1, -1, -1},
			{5, 9, 8, 5, 8, 2, 5, 2, 6, 3, 2, 8, -1, -1, -1, -1},
			{2, 3, 11, 10, 6, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{11, 0, 8, 11, 2, 0, 10, 6, 5, -1, -1, -1, -1, -1, -1, -1},
			{0, 1, 9, 2, 3, 11, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1},
			{5, 10, 6, 1, 9, 2, 9, 11, 2, 9, 8, 11, -1, -1, -1, -1},
			{6, 3, 11, 6, 5, 3, 5, 1, 3, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 11, 0, 11, 5, 0, 5, 1, 5, 11, 6, -1, -1, -1, -1},
			{3, 11, 6, 0, 3, 6, 0, 6, 5, 0, 5, 9, -1, -1, -1, -1},
			{6, 5, 9, 6, 9, 11, 11, 9, 8, -1, -1, -1, -1, -1, -1, -1},
			{5, 10, 6, 4, 7, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 3, 0, 4, 7, 3, 6, 5, 10, -1, -1, -1, -1, -1, -1, -1},
			{1, 9, 0, 5, 10, 6, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1},
			{10, 6, 5, 1, 9, 7, 1, 7, 3, 7, 9, 4, -1, -1, -1, -1},
			{6, 1, 2, 6, 5, 1, 4, 7, 8, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 5, 5, 2, 6, 3, 0, 4, 3, 4, 7, -1, -1, -1, -1},
			{8, 4, 7, 9, 0, 5, 0, 6, 5, 0, 2, 6, -1, -1, -1, -1},
			{7, 3, 9, 7, 9, 4, 3, 2, 9, 5, 9, 6, 2, 6, 9, -1},
			{3, 11, 2, 7, 8, 4, 10, 6, 5, -1, -1, -1, -1, -1, -1, -1},
			{5, 10, 6, 4, 7, 2, 4, 2, 0, 2, 7, 11, -1, -1, -1, -1},
			{0, 1, 9, 4, 7, 8, 2, 3, 11, 5, 10, 6, -1, -1, -1, -1},
			{9, 2, 1, 9, 11, 2, 9, 4, 11, 7, 11, 4, 5, 10, 6, -1},
			{8, 4, 7, 3, 11, 5, 3, 5, 1, 5, 11, 6, -1, -1, -1, -1},
			{5, 1, 11, 5, 11, 6, 1, 0, 11, 7, 11, 4, 0, 4, 11, -1},
			{0, 5, 9, 0, 6, 5, 0, 3, 6, 11, 6, 3, 8, 4, 7, -1},
			{6, 5, 9, 6, 9, 11, 4, 7, 9, 7, 11, 9, -1, -1, -1, -1},
			{10, 4, 9, 6, 4, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 10, 6, 4, 9, 10, 0, 8, 3, -1, -1, -1, -1, -1, -1, -1},
			{10, 0, 1, 10, 6, 0, 6, 4, 0, -1, -1, -1, -1, -1, -1, -1},
			{8, 3, 1, 8, 1, 6, 8, 6, 4, 6, 1, 10, -1, -1, -1, -1},
			{1, 4, 9, 1, 2, 4, 2, 6, 4, -1, -1, -1, -1, -1, -1, -1},
			{3, 0, 8, 1, 2, 9, 2, 4, 9, 2, 6, 4, -1, -1, -1, -1},
			{0, 2, 4, 4, 2, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{8, 3, 2, 8, 2, 4, 4, 2, 6, -1, -1, -1, -1, -1, -1, -1},
			{10, 4, 9, 10, 6, 4, 11, 2, 3, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 2, 2, 8, 11, 4, 9, 10, 4, 10, 6, -1, -1, -1, -1},
			{3, 11, 2, 0, 1, 6, 0, 6, 4, 6, 1, 10, -1, -1, -1, -1},
			{6, 4, 1, 6, 1, 10, 4, 8, 1, 2, 1, 11, 8, 11, 1, -1},
			{9, 6, 4, 9, 3, 6, 9, 1, 3, 11, 6, 3, -1, -1, -1, -1},
			{8, 11, 1, 8, 1, 0, 11, 6, 1, 9, 1, 4, 6, 4, 1, -1},
			{3, 11, 6, 3, 6, 0, 0, 6, 4, -1, -1, -1, -1, -1, -1, -1},
			{6, 4, 8, 11, 6, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{7, 10, 6, 7, 8, 10, 8, 9, 10, -1, -1, -1, -1, -1, -1, -1},
			{0, 7, 3, 0, 10, 7, 0, 9, 10, 6, 7, 10, -1, -1, -1, -1},
			{10, 6, 7, 1, 10, 7, 1, 7, 8, 1, 8, 0, -1, -1, -1, -1},
			{10, 6, 7, 10, 7, 1, 1, 7, 3, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 6, 1, 6, 8, 1, 8, 9, 8, 6, 7, -1, -1, -1, -1},
			{2, 6, 9, 2, 9, 1, 6, 7, 9, 0, 9, 3, 7, 3, 9, -1},
			{7, 8, 0, 7, 0, 6, 6, 0, 2, -1, -1, -1, -1, -1, -1, -1},
			{7, 3, 2, 6, 7, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{2, 3, 11, 10, 6, 8, 10, 8, 9, 8, 6, 7, -1, -1, -1, -1},
			{2, 0, 7, 2, 7, 11, 0, 9, 7, 6, 7, 10, 9, 10, 7, -1},
			{1, 8, 0, 1, 7, 8, 1, 10, 7, 6, 7, 10, 2, 3, 11, -1},
			{11, 2, 1, 11, 1, 7, 10, 6, 1, 6, 7, 1, -1, -1, -1, -1},
			{8, 9, 6, 8, 6, 7, 9, 1, 6, 11, 6, 3, 1, 3, 6, -1},
			{0, 9, 1, 11, 6, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{7, 8, 0, 7, 0, 6, 3, 11, 0, 11, 6, 0, -1, -1, -1, -1},
			{7, 11, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{7, 6, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{3, 0, 8, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 1, 9, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{8, 1, 9, 8, 3, 1, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1},
			{10, 1, 2, 6, 11, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 10, 3, 0, 8, 6, 11, 7, -1, -1, -1, -1, -1, -1, -1},
			{2, 9, 0, 2, 10, 9, 6, 11, 7, -1, -1, -1, -1, -1, -1, -1},
			{6, 11, 7, 2, 10, 3, 10, 8, 3, 10, 9, 8, -1, -1, -1, -1},
			{7, 2, 3, 6, 2, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{7, 0, 8, 7, 6, 0, 6, 2, 0, -1, -1, -1, -1, -1, -1, -1},
			{2, 7, 6, 2, 3, 7, 0, 1, 9, -1, -1, -1, -1, -1, -1, -1},
			{1, 6, 2, 1, 8, 6, 1, 9, 8, 8, 7, 6, -1, -1, -1, -1},
			{10, 7, 6, 10, 1, 7, 1, 3, 7, -1, -1, -1, -1, -1, -1, -1},
			{10, 7, 6, 1, 7, 10, 1, 8, 7, 1, 0, 8, -1, -1, -1, -1},
			{0, 3, 7, 0, 7, 10, 0, 10, 9, 6, 10, 7, -1, -1, -1, -1},
			{7, 6, 10, 7, 10, 8, 8, 10, 9, -1, -1, -1, -1, -1, -1, -1},
			{6, 8, 4, 11, 8, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{3, 6, 11, 3, 0, 6, 0, 4, 6, -1, -1, -1, -1, -1, -1, -1},
			{8, 6, 11, 8, 4, 6, 9, 0, 1, -1, -1, -1, -1, -1, -1, -1},
			{9, 4, 6, 9, 6, 3, 9, 3, 1, 11, 3, 6, -1, -1, -1, -1},
			{6, 8, 4, 6, 11, 8, 2, 10, 1, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 10, 3, 0, 11, 0, 6, 11, 0, 4, 6, -1, -1, -1, -1},
			{4, 11, 8, 4, 6, 11, 0, 2, 9, 2, 10, 9, -1, -1, -1, -1},
			{10, 9, 3, 10, 3, 2, 9, 4, 3, 11, 3, 6, 4, 6, 3, -1},
			{8, 2, 3, 8, 4, 2, 4, 6, 2, -1, -1, -1, -1, -1, -1, -1},
			{0, 4, 2, 4, 6, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 9, 0, 2, 3, 4, 2, 4, 6, 4, 3, 8, -1, -1, -1, -1},
			{1, 9, 4, 1, 4, 2, 2, 4, 6, -1, -1, -1, -1, -1, -1, -1},
			{8, 1, 3, 8, 6, 1, 8, 4, 6, 6, 10, 1, -1, -1, -1, -1},
			{10, 1, 0, 10, 0, 6, 6, 0, 4, -1, -1, -1, -1, -1, -1, -1},
			{4, 6, 3, 4, 3, 8, 6, 10, 3, 0, 3, 9, 10, 9, 3, -1},
			{10, 9, 4, 6, 10, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 9, 5, 7, 6, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 3, 4, 9, 5, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1},
			{5, 0, 1, 5, 4, 0, 7, 6, 11, -1, -1, -1, -1, -1, -1, -1},
			{11, 7, 6, 8, 3, 4, 3, 5, 4, 3, 1, 5, -1, -1, -1, -1},
			{9, 5, 4, 10, 1, 2, 7, 6, 11, -1, -1, -1, -1, -1, -1, -1},
			{6, 11, 7, 1, 2, 10, 0, 8, 3, 4, 9, 5, -1, -1, -1, -1},
			{7, 6, 11, 5, 4, 10, 4, 2, 10, 4, 0, 2, -1, -1, -1, -1},
			{3, 4, 8, 3, 5, 4, 3, 2, 5, 10, 5, 2, 11, 7, 6, -1},
			{7, 2, 3, 7, 6, 2, 5, 4, 9, -1, -1, -1, -1, -1, -1, -1},
			{9, 5, 4, 0, 8, 6, 0, 6, 2, 6, 8, 7, -1, -1, -1, -1},
			{3, 6, 2, 3, 7, 6, 1, 5, 0, 5, 4, 0, -1, -1, -1, -1},
			{6, 2, 8, 6, 8, 7, 2, 1, 8, 4, 8, 5, 1, 5, 8, -1},
			{9, 5, 4, 10, 1, 6, 1, 7, 6, 1, 3, 7, -1, -1, -1, -1},
			{1, 6, 10, 1, 7, 6, 1, 0, 7, 8, 7, 0, 9, 5, 4, -1},
			{4, 0, 10, 4, 10, 5, 0, 3, 10, 6, 10, 7, 3, 7, 10, -1},
			{7, 6, 10, 7, 10, 8, 5, 4, 10, 4, 8, 10, -1, -1, -1, -1},
			{6, 9, 5, 6, 11, 9, 11, 8, 9, -1, -1, -1, -1, -1, -1, -1},
			{3, 6, 11, 0, 6, 3, 0, 5, 6, 0, 9, 5, -1, -1, -1, -1},
			{0, 11, 8, 0, 5, 11, 0, 1, 5, 5, 6, 11, -1, -1, -1, -1},
			{6, 11, 3, 6, 3, 5, 5, 3, 1, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 10, 9, 5, 11, 9, 11, 8, 11, 5, 6, -1, -1, -1, -1},
			{0, 11, 3, 0, 6, 11, 0, 9, 6, 5, 6, 9, 1, 2, 10, -1},
			{11, 8, 5, 11, 5, 6, 8, 0, 5, 10, 5, 2, 0, 2, 5, -1},
			{6, 11, 3, 6, 3, 5, 2, 10, 3, 10, 5, 3, -1, -1, -1, -1},
			{5, 8, 9, 5, 2, 8, 5, 6, 2, 3, 8, 2, -1, -1, -1, -1},
			{9, 5, 6, 9, 6, 0, 0, 6, 2, -1, -1, -1, -1, -1, -1, -1},
			{1, 5, 8, 1, 8, 0, 5, 6, 8, 3, 8, 2, 6, 2, 8, -1},
			{1, 5, 6, 2, 1, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 3, 6, 1, 6, 10, 3, 8, 6, 5, 6, 9, 8, 9, 6, -1},
			{10, 1, 0, 10, 0, 6, 9, 5, 0, 5, 6, 0, -1, -1, -1, -1},
			{0, 3, 8, 5, 6, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{10, 5, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{11, 5, 10, 7, 5, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{11, 5, 10, 11, 7, 5, 8, 3, 0, -1, -1, -1, -1, -1, -1, -1},
			{5, 11, 7, 5, 10, 11, 1, 9, 0, -1, -1, -1, -1, -1, -1, -1},
			{10, 7, 5, 10, 11, 7, 9, 8, 1, 8, 3, 1, -1, -1, -1, -1},
			{11, 1, 2, 11, 7, 1, 7, 5, 1, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 3, 1, 2, 7, 1, 7, 5, 7, 2, 11, -1, -1, -1, -1},
			{9, 7, 5, 9, 2, 7, 9, 0, 2, 2, 11, 7, -1, -1, -1, -1},
			{7, 5, 2, 7, 2, 11, 5, 9, 2, 3, 2, 8, 9, 8, 2, -1},
			{2, 5, 10, 2, 3, 5, 3, 7, 5, -1, -1, -1, -1, -1, -1, -1},
			{8, 2, 0, 8, 5, 2, 8, 7, 5, 10, 2, 5, -1, -1, -1, -1},
			{9, 0, 1, 5, 10, 3, 5, 3, 7, 3, 10, 2, -1, -1, -1, -1},
			{9, 8, 2, 9, 2, 1, 8, 7, 2, 10, 2, 5, 7, 5, 2, -1},
			{1, 3, 5, 3, 7, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 7, 0, 7, 1, 1, 7, 5, -1, -1, -1, -1, -1, -1, -1},
			{9, 0, 3, 9, 3, 5, 5, 3, 7, -1, -1, -1, -1, -1, -1, -1},
			{9, 8, 7, 5, 9, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{5, 8, 4, 5, 10, 8, 10, 11, 8, -1, -1, -1, -1, -1, -1, -1},
			{5, 0, 4, 5, 11, 0, 5, 10, 11, 11, 3, 0, -1, -1, -1, -1},
			{0, 1, 9, 8, 4, 10, 8, 10, 11, 10, 4, 5, -1, -1, -1, -1},
			{10, 11, 4, 10, 4, 5, 11, 3, 4, 9, 4, 1, 3, 1, 4, -1},
			{2, 5, 1, 2, 8, 5, 2, 11, 8, 4, 5, 8, -1, -1, -1, -1},
			{0, 4, 11, 0, 11, 3, 4, 5, 11, 2, 11, 1, 5, 1, 11, -1},
			{0, 2, 5, 0, 5, 9, 2, 11, 5, 4, 5, 8, 11, 8, 5, -1},
			{9, 4, 5, 2, 11, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{2, 5, 10, 3, 5, 2, 3, 4, 5, 3, 8, 4, -1, -1, -1, -1},
			{5, 10, 2, 5, 2, 4, 4, 2, 0, -1, -1, -1, -1, -1, -1, -1},
			{3, 10, 2, 3, 5, 10, 3, 8, 5, 4, 5, 8, 0, 1, 9, -1},
			{5, 10, 2, 5, 2, 4, 1, 9, 2, 9, 4, 2, -1, -1, -1, -1},
			{8, 4, 5, 8, 5, 3, 3, 5, 1, -1, -1, -1, -1, -1, -1, -1},
			{0, 4, 5, 1, 0, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{8, 4, 5, 8, 5, 3, 9, 0, 5, 0, 3, 5, -1, -1, -1, -1},
			{9, 4, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 11, 7, 4, 9, 11, 9, 10, 11, -1, -1, -1, -1, -1, -1, -1},
			{0, 8, 3, 4, 9, 7, 9, 11, 7, 9, 10, 11, -1, -1, -1, -1},
			{1, 10, 11, 1, 11, 4, 1, 4, 0, 7, 4, 11, -1, -1, -1, -1},
			{3, 1, 4, 3, 4, 8, 1, 10, 4, 7, 4, 11, 10, 11, 4, -1},
			{4, 11, 7, 9, 11, 4, 9, 2, 11, 9, 1, 2, -1, -1, -1, -1},
			{9, 7, 4, 9, 11, 7, 9, 1, 11, 2, 11, 1, 0, 8, 3, -1},
			{11, 7, 4, 11, 4, 2, 2, 4, 0, -1, -1, -1, -1, -1, -1, -1},
			{11, 7, 4, 11, 4, 2, 8, 3, 4, 3, 2, 4, -1, -1, -1, -1},
			{2, 9, 10, 2, 7, 9, 2, 3, 7, 7, 4, 9, -1, -1, -1, -1},
			{9, 10, 7, 9, 7, 4, 10, 2, 7, 8, 7, 0, 2, 0, 7, -1},
			{3, 7, 10, 3, 10, 2, 7, 4, 10, 1, 10, 0, 4, 0, 10, -1},
			{1, 10, 2, 8, 7, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 9, 1, 4, 1, 7, 7, 1, 3, -1, -1, -1, -1, -1, -1, -1},
			{4, 9, 1, 4, 1, 7, 0, 8, 1, 8, 7, 1, -1, -1, -1, -1},
			{4, 0, 3, 7, 4, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{4, 8, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{9, 10, 8, 10, 11, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{3, 0, 9, 3, 9, 11, 11, 9, 10, -1, -1, -1, -1, -1, -1, -1},
			{0, 1, 10, 0, 10, 8, 8, 10, 11, -1, -1, -1, -1, -1, -1, -1},
			{3, 1, 10, 11, 3, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 2, 11, 1, 11, 9, 9, 11, 8, -1, -1, -1, -1, -1, -1, -1},
			{3, 0, 9, 3, 9, 11, 1, 2, 9, 2, 11, 9, -1, -1, -1, -1},
			{0, 2, 11, 8, 0, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{3, 2, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{2, 3, 8, 2, 8, 10, 10, 8, 9, -1, -1, -1, -1, -1, -1, -1},
			{9, 10, 2, 0, 9, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{2, 3, 8, 2, 8, 10, 0, 1, 8, 1, 10, 8, -1, -1, -1, -1},
			{1, 10, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{1, 3, 8, 9, 1, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 9, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{0, 3, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
			{-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1} 
		};

		/*
		   Determine the index into the edge table which
		   tells us which vertices are inside of the surface
		*/
		cubeindex = 0;
		if (grid.val[0] < isolevel) cubeindex |= 1;
		if (grid.val[1] < isolevel) cubeindex |= 2;
		if (grid.val[2] < isolevel) cubeindex |= 4;
		if (grid.val[3] < isolevel) cubeindex |= 8;
		if (grid.val[4] < isolevel) cubeindex |= 16;
		if (grid.val[5] < isolevel) cubeindex |= 32;
		if (grid.val[6] < isolevel) cubeindex |= 64;
		if (grid.val[7] < isolevel) cubeindex |= 128;

		/* Cube is entirely in/out of the surface */
		if (edgeTable[cubeindex] == 0)
			return(0);

		/* Find the vertices where the surface intersects the cube */
		if (edgeTable[cubeindex] & 1)
			vertlist[0] = VertexInterp(isolevel, grid.p[0], grid.p[1], grid.val[0], grid.val[1]);
		if (edgeTable[cubeindex] & 2)
			vertlist[1] = VertexInterp(isolevel, grid.p[1], grid.p[2], grid.val[1], grid.val[2]);
		if (edgeTable[cubeindex] & 4)
			vertlist[2] = VertexInterp(isolevel, grid.p[2], grid.p[3], grid.val[2], grid.val[3]);
		if (edgeTable[cubeindex] & 8)
			vertlist[3] = VertexInterp(isolevel, grid.p[3], grid.p[0], grid.val[3], grid.val[0]);
		if (edgeTable[cubeindex] & 16)
			vertlist[4] = VertexInterp(isolevel, grid.p[4], grid.p[5], grid.val[4], grid.val[5]);
		if (edgeTable[cubeindex] & 32)
			vertlist[5] = VertexInterp(isolevel, grid.p[5], grid.p[6], grid.val[5], grid.val[6]);
		if (edgeTable[cubeindex] & 64)
			vertlist[6] = VertexInterp(isolevel, grid.p[6], grid.p[7], grid.val[6], grid.val[7]);
		if (edgeTable[cubeindex] & 128)
			vertlist[7] = VertexInterp(isolevel, grid.p[7], grid.p[4], grid.val[7], grid.val[4]);
		if (edgeTable[cubeindex] & 256)
			vertlist[8] = VertexInterp(isolevel, grid.p[0], grid.p[4], grid.val[0], grid.val[4]);
		if (edgeTable[cubeindex] & 512)
			vertlist[9] = VertexInterp(isolevel, grid.p[1], grid.p[5], grid.val[1], grid.val[5]);
		if (edgeTable[cubeindex] & 1024)
			vertlist[10] = VertexInterp(isolevel, grid.p[2], grid.p[6], grid.val[2], grid.val[6]);
		if (edgeTable[cubeindex] & 2048)
			vertlist[11] = VertexInterp(isolevel, grid.p[3], grid.p[7], grid.val[3], grid.val[7]);

		/* Create the triangle */
		ntriang = 0;
		for (i = 0; triTable[cubeindex][i] != -1; i += 3) 
		{
			triangles[ntriang].p[0] = vertlist[triTable[cubeindex][i]];
			triangles[ntriang].p[2] = vertlist[triTable[cubeindex][i + 1]];
			triangles[ntriang].p[1] = vertlist[triTable[cubeindex][i + 2]];
			ntriang++;
		}

		return(ntriang);
	}
}
#endif

// ***********************************************************
//
// ***********************************************************
class ndMarchingCubes::ndKey_xlow
{
	public:
	ndKey_xlow(void* const) {}
	ndInt32 GetKey(const ndGridHash& cell) const
	{
		return cell.m_xLow;
	}
};

class ndMarchingCubes::ndKey_xhigh
{
	public:
	ndKey_xhigh(void* const) {}
	ndInt32 GetKey(const ndGridHash& cell) const
	{
		return cell.m_xHigh;
	}
};

class ndMarchingCubes::ndKey_ylow
{
	public:
	ndKey_ylow(void* const) {}
	ndInt32 GetKey(const ndGridHash& cell) const
	{
		return cell.m_yLow;
	}
};

class ndMarchingCubes::ndKey_yhigh
{
	public:
	ndKey_yhigh(void* const) {}
	ndInt32 GetKey(const ndGridHash& cell) const
	{
		return cell.m_yHigh;
	}
};

class ndMarchingCubes::ndKey_zlow
{
	public:
	ndKey_zlow(void* const) {}
	ndInt32 GetKey(const ndGridHash& cell) const
	{
		return cell.m_zLow;
	}
};

class ndMarchingCubes::ndKey_zhigh
{
	public:
	ndKey_zhigh(void* const) {}
	ndInt32 GetKey(const ndGridHash& cell) const
	{
		return cell.m_zHigh;
	}
};


class ndMarchingCubes::ndIsoCell
{
	public:
	ndVector m_isoValues[8];
};

class ndMarchingCubes::ndGridHashSteps
{
	public:
	ndGridHashSteps()
	{
		m_steps[0] = ndGridHash(-1, -1, -1);
		m_steps[1] = ndGridHash(0, -1, -1);
		m_steps[2] = ndGridHash(-1, 0, -1);
		m_steps[3] = ndGridHash(0, 0, -1);
		m_steps[4] = ndGridHash(-1, -1, 0);
		m_steps[5] = ndGridHash(0, -1, 0);
		m_steps[6] = ndGridHash(-1, 0, 0);
		m_steps[7] = ndGridHash(0, 0, 0);

		m_cellType[0] = 5;
		m_cellType[1] = 6;
		m_cellType[2] = 1;
		m_cellType[3] = 2;
		m_cellType[4] = 4;
		m_cellType[5] = 7;
		m_cellType[6] = 0;
		m_cellType[7] = 3;
	}

	ndGridHash m_steps[8];
	ndInt8 m_cellType[8];
};

ndVector ndMarchingCubes::m_gridCorners[] =
{
	ndVector(ndFloat32(0.0f), ndFloat32(-1.0f), ndFloat32(-1.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(0.0f), ndFloat32(-1.0f), ndFloat32(0.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(-1.0f), ndFloat32(-1.0f), ndFloat32(0.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(-1.0f), ndFloat32(-1.0f), ndFloat32(-1.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(0.0f), ndFloat32(0.0f), ndFloat32(-1.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(0.0f), ndFloat32(0.0f), ndFloat32(0.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(-1.0f), ndFloat32(0.0f), ndFloat32(0.0f), ndFloat32(0.0f)),
	ndVector(ndFloat32(-1.0f), ndFloat32(0.0f), ndFloat32(-1.0f), ndFloat32(0.0f))
};

ndInt32 ndMarchingCubes::m_facesScan[] = 
{ 
	0,0,1,2,4,5,7,9,12,13,15,17,20,22,25,28,30,31,
	33,35,38,40,43,46,50,52,55,58,62,65,69,73,76,
	77,79,81,84,86,89,92,96,98,101,104,108,111,115,
	119,122,124,127,130,132,135,139,143,146,149,153,
	157,160,164,169,174,176,177,179,181,184,186,189,
	192,196,198,201,204,208,211,215,219,222,224,227,
	230,234,237,241,245,250,253,257,261,266,270,275,
	280,284,286,289,292,296,299,303,305,308,311,315,
	319,324,328,333,336,338,341,345,349,352,356,361,
	364,366,370,375,380,384,389,391,395,396,397,399,
	401,404,406,409,412,416,418,421,424,428,431,435,
	439,442,444,447,450,454,457,461,465,470,473,475,
	479,482,486,489,494,496,498,501,504,508,511,515,
	519,524,527,531,535,540,544,549,554,558,561,565,
	569,572,576,581,586,590,594,597,602,604,609,613,
	615,616,618,621,624,628,631,635,639,644,647,651,
	655,660,662,665,668,670,673,677,681,686,690,695,
	700,702,706,709,714,718,721,723,727,728,731,735,
	739,744,748,753,756,760,764,769,774,776,779,783,
	785,786,788,791,794,796,799,803,805,806,809,811,
	815,816,818,819,820,820 };

ndInt32 ndMarchingCubes::m_edgeScan[] = 
{ 
	0,0,3,6,10,13,19,23,28,31,35,41,46,50,55,60,
	64,67,71,77,82,88,95,102,108,114,119,128,134,
	141,147,155,160,163,169,173,178,184,193,198,
	204,210,217,224,230,237,245,251,256,260,265,
	270,274,281,289,295,300,307,313,321,326,334,
	341,348,352,355,361,367,374,378,385,390,396,
	402,409,418,426,431,437,443,448,454,461,470,
	478,485,493,501,508,517,525,537,546,554,561,
	570,576,580,587,592,598,603,611,615,620,627,
	635,643,650,656,663,668,672,677,683,689,694,
	700,707,712,716,724,731,740,746,753,759,765,
	768,771,777,783,790,796,805,812,820,824,829,
	836,842,847,853,859,864,868,873,880,886,893,
	901,909,916,921,925,933,938,944,949,956,960,
	966,975,982,990,999,1011,1019,1028,1035,1043,
	1051,1058,1066,1075,1082,1088,1093,1099,1105,
	1110,1118,1127,1134,1140,1146,1151,1158,1162,
	1169,1175,1181,1184,1188,1195,1202,1210,1215,
	1223,1229,1236,1241,1247,1255,1262,1266,1271,
	1276,1280,1285,1291,1299,1306,1312,1319,1326,
	1332,1338,1343,1352,1358,1363,1367,1373,1376,
	1381,1389,1395,1402,1408,1417,1422,1428,1434,
	1441,1448,1454,1459,1465,1469,1472,1476,1481,
	1486,1490,1495,1501,1505,1508,1513,1517,1523,
	1526,1530,1533,1536,1536 
};

ndInt32 ndMarchingCubes::m_faces[][3] =
{
	{ 0, 8, 3 },
	{ 0, 1, 9 },
	{ 1, 8, 3 },
	{ 9, 8, 1 },
	{ 1, 2, 10 },
	{ 0, 8, 3 },
	{ 1, 2, 10 },
	{ 9, 2, 10 },
	{ 0, 2, 9 },
	{ 2, 8, 3 },
	{ 2, 10, 8 },
	{ 10, 9, 8 },
	{ 3, 11, 2 },
	{ 0, 11, 2 },
	{ 8, 11, 0 },
	{ 1, 9, 0 },
	{ 2, 3, 11 },
	{ 1, 11, 2 },
	{ 1, 9, 11 },
	{ 9, 8, 11 },
	{ 3, 10, 1 },
	{ 11, 10, 3 },
	{ 0, 10, 1 },
	{ 0, 8, 10 },
	{ 8, 11, 10 },
	{ 3, 9, 0 },
	{ 3, 11, 9 },
	{ 11, 10, 9 },
	{ 9, 8, 10 },
	{ 10, 8, 11 },
	{ 4, 7, 8 },
	{ 4, 3, 0 },
	{ 7, 3, 4 },
	{ 0, 1, 9 },
	{ 8, 4, 7 },
	{ 4, 1, 9 },
	{ 4, 7, 1 },
	{ 7, 3, 1 },
	{ 1, 2, 10 },
	{ 8, 4, 7 },
	{ 3, 4, 7 },
	{ 3, 0, 4 },
	{ 1, 2, 10 },
	{ 9, 2, 10 },
	{ 9, 0, 2 },
	{ 8, 4, 7 },
	{ 2, 10, 9 },
	{ 2, 9, 7 },
	{ 2, 7, 3 },
	{ 7, 9, 4 },
	{ 8, 4, 7 },
	{ 3, 11, 2 },
	{ 11, 4, 7 },
	{ 11, 2, 4 },
	{ 2, 0, 4 },
	{ 9, 0, 1 },
	{ 8, 4, 7 },
	{ 2, 3, 11 },
	{ 4, 7, 11 },
	{ 9, 4, 11 },
	{ 9, 11, 2 },
	{ 9, 2, 1 },
	{ 3, 10, 1 },
	{ 3, 11, 10 },
	{ 7, 8, 4 },
	{ 1, 11, 10 },
	{ 1, 4, 11 },
	{ 1, 0, 4 },
	{ 7, 11, 4 },
	{ 4, 7, 8 },
	{ 9, 0, 11 },
	{ 9, 11, 10 },
	{ 11, 0, 3 },
	{ 4, 7, 11 },
	{ 4, 11, 9 },
	{ 9, 11, 10 },
	{ 9, 5, 4 },
	{ 9, 5, 4 },
	{ 0, 8, 3 },
	{ 0, 5, 4 },
	{ 1, 5, 0 },
	{ 8, 5, 4 },
	{ 8, 3, 5 },
	{ 3, 1, 5 },
	{ 1, 2, 10 },
	{ 9, 5, 4 },
	{ 3, 0, 8 },
	{ 1, 2, 10 },
	{ 4, 9, 5 },
	{ 5, 2, 10 },
	{ 5, 4, 2 },
	{ 4, 0, 2 },
	{ 2, 10, 5 },
	{ 3, 2, 5 },
	{ 3, 5, 4 },
	{ 3, 4, 8 },
	{ 9, 5, 4 },
	{ 2, 3, 11 },
	{ 0, 11, 2 },
	{ 0, 8, 11 },
	{ 4, 9, 5 },
	{ 0, 5, 4 },
	{ 0, 1, 5 },
	{ 2, 3, 11 },
	{ 2, 1, 5 },
	{ 2, 5, 8 },
	{ 2, 8, 11 },
	{ 4, 8, 5 },
	{ 10, 3, 11 },
	{ 10, 1, 3 },
	{ 9, 5, 4 },
	{ 4, 9, 5 },
	{ 0, 8, 1 },
	{ 8, 10, 1 },
	{ 8, 11, 10 },
	{ 5, 4, 0 },
	{ 5, 0, 11 },
	{ 5, 11, 10 },
	{ 11, 0, 3 },
	{ 5, 4, 8 },
	{ 5, 8, 10 },
	{ 10, 8, 11 },
	{ 9, 7, 8 },
	{ 5, 7, 9 },
	{ 9, 3, 0 },
	{ 9, 5, 3 },
	{ 5, 7, 3 },
	{ 0, 7, 8 },
	{ 0, 1, 7 },
	{ 1, 5, 7 },
	{ 1, 5, 3 },
	{ 3, 5, 7 },
	{ 9, 7, 8 },
	{ 9, 5, 7 },
	{ 10, 1, 2 },
	{ 10, 1, 2 },
	{ 9, 5, 0 },
	{ 5, 3, 0 },
	{ 5, 7, 3 },
	{ 8, 0, 2 },
	{ 8, 2, 5 },
	{ 8, 5, 7 },
	{ 10, 5, 2 },
	{ 2, 10, 5 },
	{ 2, 5, 3 },
	{ 3, 5, 7 },
	{ 7, 9, 5 },
	{ 7, 8, 9 },
	{ 3, 11, 2 },
	{ 9, 5, 7 },
	{ 9, 7, 2 },
	{ 9, 2, 0 },
	{ 2, 7, 11 },
	{ 2, 3, 11 },
	{ 0, 1, 8 },
	{ 1, 7, 8 },
	{ 1, 5, 7 },
	{ 11, 2, 1 },
	{ 11, 1, 7 },
	{ 7, 1, 5 },
	{ 9, 5, 8 },
	{ 8, 5, 7 },
	{ 10, 1, 3 },
	{ 10, 3, 11 },
	{ 5, 7, 0 },
	{ 5, 0, 9 },
	{ 7, 11, 0 },
	{ 1, 0, 10 },
	{ 11, 10, 0 },
	{ 11, 10, 0 },
	{ 11, 0, 3 },
	{ 10, 5, 0 },
	{ 8, 0, 7 },
	{ 5, 7, 0 },
	{ 11, 10, 5 },
	{ 7, 11, 5 },
	{ 10, 6, 5 },
	{ 0, 8, 3 },
	{ 5, 10, 6 },
	{ 9, 0, 1 },
	{ 5, 10, 6 },
	{ 1, 8, 3 },
	{ 1, 9, 8 },
	{ 5, 10, 6 },
	{ 1, 6, 5 },
	{ 2, 6, 1 },
	{ 1, 6, 5 },
	{ 1, 2, 6 },
	{ 3, 0, 8 },
	{ 9, 6, 5 },
	{ 9, 0, 6 },
	{ 0, 2, 6 },
	{ 5, 9, 8 },
	{ 5, 8, 2 },
	{ 5, 2, 6 },
	{ 3, 2, 8 },
	{ 2, 3, 11 },
	{ 10, 6, 5 },
	{ 11, 0, 8 },
	{ 11, 2, 0 },
	{ 10, 6, 5 },
	{ 0, 1, 9 },
	{ 2, 3, 11 },
	{ 5, 10, 6 },
	{ 5, 10, 6 },
	{ 1, 9, 2 },
	{ 9, 11, 2 },
	{ 9, 8, 11 },
	{ 6, 3, 11 },
	{ 6, 5, 3 },
	{ 5, 1, 3 },
	{ 0, 8, 11 },
	{ 0, 11, 5 },
	{ 0, 5, 1 },
	{ 5, 11, 6 },
	{ 3, 11, 6 },
	{ 0, 3, 6 },
	{ 0, 6, 5 },
	{ 0, 5, 9 },
	{ 6, 5, 9 },
	{ 6, 9, 11 },
	{ 11, 9, 8 },
	{ 5, 10, 6 },
	{ 4, 7, 8 },
	{ 4, 3, 0 },
	{ 4, 7, 3 },
	{ 6, 5, 10 },
	{ 1, 9, 0 },
	{ 5, 10, 6 },
	{ 8, 4, 7 },
	{ 10, 6, 5 },
	{ 1, 9, 7 },
	{ 1, 7, 3 },
	{ 7, 9, 4 },
	{ 6, 1, 2 },
	{ 6, 5, 1 },
	{ 4, 7, 8 },
	{ 1, 2, 5 },
	{ 5, 2, 6 },
	{ 3, 0, 4 },
	{ 3, 4, 7 },
	{ 8, 4, 7 },
	{ 9, 0, 5 },
	{ 0, 6, 5 },
	{ 0, 2, 6 },
	{ 7, 3, 9 },
	{ 7, 9, 4 },
	{ 3, 2, 9 },
	{ 5, 9, 6 },
	{ 2, 6, 9 },
	{ 3, 11, 2 },
	{ 7, 8, 4 },
	{ 10, 6, 5 },
	{ 5, 10, 6 },
	{ 4, 7, 2 },
	{ 4, 2, 0 },
	{ 2, 7, 11 },
	{ 0, 1, 9 },
	{ 4, 7, 8 },
	{ 2, 3, 11 },
	{ 5, 10, 6 },
	{ 9, 2, 1 },
	{ 9, 11, 2 },
	{ 9, 4, 11 },
	{ 7, 11, 4 },
	{ 5, 10, 6 },
	{ 8, 4, 7 },
	{ 3, 11, 5 },
	{ 3, 5, 1 },
	{ 5, 11, 6 },
	{ 5, 1, 11 },
	{ 5, 11, 6 },
	{ 1, 0, 11 },
	{ 7, 11, 4 },
	{ 0, 4, 11 },
	{ 0, 5, 9 },
	{ 0, 6, 5 },
	{ 0, 3, 6 },
	{ 11, 6, 3 },
	{ 8, 4, 7 },
	{ 6, 5, 9 },
	{ 6, 9, 11 },
	{ 4, 7, 9 },
	{ 7, 11, 9 },
	{ 10, 4, 9 },
	{ 6, 4, 10 },
	{ 4, 10, 6 },
	{ 4, 9, 10 },
	{ 0, 8, 3 },
	{ 10, 0, 1 },
	{ 10, 6, 0 },
	{ 6, 4, 0 },
	{ 8, 3, 1 },
	{ 8, 1, 6 },
	{ 8, 6, 4 },
	{ 6, 1, 10 },
	{ 1, 4, 9 },
	{ 1, 2, 4 },
	{ 2, 6, 4 },
	{ 3, 0, 8 },
	{ 1, 2, 9 },
	{ 2, 4, 9 },
	{ 2, 6, 4 },
	{ 0, 2, 4 },
	{ 4, 2, 6 },
	{ 8, 3, 2 },
	{ 8, 2, 4 },
	{ 4, 2, 6 },
	{ 10, 4, 9 },
	{ 10, 6, 4 },
	{ 11, 2, 3 },
	{ 0, 8, 2 },
	{ 2, 8, 11 },
	{ 4, 9, 10 },
	{ 4, 10, 6 },
	{ 3, 11, 2 },
	{ 0, 1, 6 },
	{ 0, 6, 4 },
	{ 6, 1, 10 },
	{ 6, 4, 1 },
	{ 6, 1, 10 },
	{ 4, 8, 1 },
	{ 2, 1, 11 },
	{ 8, 11, 1 },
	{ 9, 6, 4 },
	{ 9, 3, 6 },
	{ 9, 1, 3 },
	{ 11, 6, 3 },
	{ 8, 11, 1 },
	{ 8, 1, 0 },
	{ 11, 6, 1 },
	{ 9, 1, 4 },
	{ 6, 4, 1 },
	{ 3, 11, 6 },
	{ 3, 6, 0 },
	{ 0, 6, 4 },
	{ 6, 4, 8 },
	{ 11, 6, 8 },
	{ 7, 10, 6 },
	{ 7, 8, 10 },
	{ 8, 9, 10 },
	{ 0, 7, 3 },
	{ 0, 10, 7 },
	{ 0, 9, 10 },
	{ 6, 7, 10 },
	{ 10, 6, 7 },
	{ 1, 10, 7 },
	{ 1, 7, 8 },
	{ 1, 8, 0 },
	{ 10, 6, 7 },
	{ 10, 7, 1 },
	{ 1, 7, 3 },
	{ 1, 2, 6 },
	{ 1, 6, 8 },
	{ 1, 8, 9 },
	{ 8, 6, 7 },
	{ 2, 6, 9 },
	{ 2, 9, 1 },
	{ 6, 7, 9 },
	{ 0, 9, 3 },
	{ 7, 3, 9 },
	{ 7, 8, 0 },
	{ 7, 0, 6 },
	{ 6, 0, 2 },
	{ 7, 3, 2 },
	{ 6, 7, 2 },
	{ 2, 3, 11 },
	{ 10, 6, 8 },
	{ 10, 8, 9 },
	{ 8, 6, 7 },
	{ 2, 0, 7 },
	{ 2, 7, 11 },
	{ 0, 9, 7 },
	{ 6, 7, 10 },
	{ 9, 10, 7 },
	{ 1, 8, 0 },
	{ 1, 7, 8 },
	{ 1, 10, 7 },
	{ 6, 7, 10 },
	{ 2, 3, 11 },
	{ 11, 2, 1 },
	{ 11, 1, 7 },
	{ 10, 6, 1 },
	{ 6, 7, 1 },
	{ 8, 9, 6 },
	{ 8, 6, 7 },
	{ 9, 1, 6 },
	{ 11, 6, 3 },
	{ 1, 3, 6 },
	{ 0, 9, 1 },
	{ 11, 6, 7 },
	{ 7, 8, 0 },
	{ 7, 0, 6 },
	{ 3, 11, 0 },
	{ 11, 6, 0 },
	{ 7, 11, 6 },
	{ 7, 6, 11 },
	{ 3, 0, 8 },
	{ 11, 7, 6 },
	{ 0, 1, 9 },
	{ 11, 7, 6 },
	{ 8, 1, 9 },
	{ 8, 3, 1 },
	{ 11, 7, 6 },
	{ 10, 1, 2 },
	{ 6, 11, 7 },
	{ 1, 2, 10 },
	{ 3, 0, 8 },
	{ 6, 11, 7 },
	{ 2, 9, 0 },
	{ 2, 10, 9 },
	{ 6, 11, 7 },
	{ 6, 11, 7 },
	{ 2, 10, 3 },
	{ 10, 8, 3 },
	{ 10, 9, 8 },
	{ 7, 2, 3 },
	{ 6, 2, 7 },
	{ 7, 0, 8 },
	{ 7, 6, 0 },
	{ 6, 2, 0 },
	{ 2, 7, 6 },
	{ 2, 3, 7 },
	{ 0, 1, 9 },
	{ 1, 6, 2 },
	{ 1, 8, 6 },
	{ 1, 9, 8 },
	{ 8, 7, 6 },
	{ 10, 7, 6 },
	{ 10, 1, 7 },
	{ 1, 3, 7 },
	{ 10, 7, 6 },
	{ 1, 7, 10 },
	{ 1, 8, 7 },
	{ 1, 0, 8 },
	{ 0, 3, 7 },
	{ 0, 7, 10 },
	{ 0, 10, 9 },
	{ 6, 10, 7 },
	{ 7, 6, 10 },
	{ 7, 10, 8 },
	{ 8, 10, 9 },
	{ 6, 8, 4 },
	{ 11, 8, 6 },
	{ 3, 6, 11 },
	{ 3, 0, 6 },
	{ 0, 4, 6 },
	{ 8, 6, 11 },
	{ 8, 4, 6 },
	{ 9, 0, 1 },
	{ 9, 4, 6 },
	{ 9, 6, 3 },
	{ 9, 3, 1 },
	{ 11, 3, 6 },
	{ 6, 8, 4 },
	{ 6, 11, 8 },
	{ 2, 10, 1 },
	{ 1, 2, 10 },
	{ 3, 0, 11 },
	{ 0, 6, 11 },
	{ 0, 4, 6 },
	{ 4, 11, 8 },
	{ 4, 6, 11 },
	{ 0, 2, 9 },
	{ 2, 10, 9 },
	{ 10, 9, 3 },
	{ 10, 3, 2 },
	{ 9, 4, 3 },
	{ 11, 3, 6 },
	{ 4, 6, 3 },
	{ 8, 2, 3 },
	{ 8, 4, 2 },
	{ 4, 6, 2 },
	{ 0, 4, 2 },
	{ 4, 6, 2 },
	{ 1, 9, 0 },
	{ 2, 3, 4 },
	{ 2, 4, 6 },
	{ 4, 3, 8 },
	{ 1, 9, 4 },
	{ 1, 4, 2 },
	{ 2, 4, 6 },
	{ 8, 1, 3 },
	{ 8, 6, 1 },
	{ 8, 4, 6 },
	{ 6, 10, 1 },
	{ 10, 1, 0 },
	{ 10, 0, 6 },
	{ 6, 0, 4 },
	{ 4, 6, 3 },
	{ 4, 3, 8 },
	{ 6, 10, 3 },
	{ 0, 3, 9 },
	{ 10, 9, 3 },
	{ 10, 9, 4 },
	{ 6, 10, 4 },
	{ 4, 9, 5 },
	{ 7, 6, 11 },
	{ 0, 8, 3 },
	{ 4, 9, 5 },
	{ 11, 7, 6 },
	{ 5, 0, 1 },
	{ 5, 4, 0 },
	{ 7, 6, 11 },
	{ 11, 7, 6 },
	{ 8, 3, 4 },
	{ 3, 5, 4 },
	{ 3, 1, 5 },
	{ 9, 5, 4 },
	{ 10, 1, 2 },
	{ 7, 6, 11 },
	{ 6, 11, 7 },
	{ 1, 2, 10 },
	{ 0, 8, 3 },
	{ 4, 9, 5 },
	{ 7, 6, 11 },
	{ 5, 4, 10 },
	{ 4, 2, 10 },
	{ 4, 0, 2 },
	{ 3, 4, 8 },
	{ 3, 5, 4 },
	{ 3, 2, 5 },
	{ 10, 5, 2 },
	{ 11, 7, 6 },
	{ 7, 2, 3 },
	{ 7, 6, 2 },
	{ 5, 4, 9 },
	{ 9, 5, 4 },
	{ 0, 8, 6 },
	{ 0, 6, 2 },
	{ 6, 8, 7 },
	{ 3, 6, 2 },
	{ 3, 7, 6 },
	{ 1, 5, 0 },
	{ 5, 4, 0 },
	{ 6, 2, 8 },
	{ 6, 8, 7 },
	{ 2, 1, 8 },
	{ 4, 8, 5 },
	{ 1, 5, 8 },
	{ 9, 5, 4 },
	{ 10, 1, 6 },
	{ 1, 7, 6 },
	{ 1, 3, 7 },
	{ 1, 6, 10 },
	{ 1, 7, 6 },
	{ 1, 0, 7 },
	{ 8, 7, 0 },
	{ 9, 5, 4 },
	{ 4, 0, 10 },
	{ 4, 10, 5 },
	{ 0, 3, 10 },
	{ 6, 10, 7 },
	{ 3, 7, 10 },
	{ 7, 6, 10 },
	{ 7, 10, 8 },
	{ 5, 4, 10 },
	{ 4, 8, 10 },
	{ 6, 9, 5 },
	{ 6, 11, 9 },
	{ 11, 8, 9 },
	{ 3, 6, 11 },
	{ 0, 6, 3 },
	{ 0, 5, 6 },
	{ 0, 9, 5 },
	{ 0, 11, 8 },
	{ 0, 5, 11 },
	{ 0, 1, 5 },
	{ 5, 6, 11 },
	{ 6, 11, 3 },
	{ 6, 3, 5 },
	{ 5, 3, 1 },
	{ 1, 2, 10 },
	{ 9, 5, 11 },
	{ 9, 11, 8 },
	{ 11, 5, 6 },
	{ 0, 11, 3 },
	{ 0, 6, 11 },
	{ 0, 9, 6 },
	{ 5, 6, 9 },
	{ 1, 2, 10 },
	{ 11, 8, 5 },
	{ 11, 5, 6 },
	{ 8, 0, 5 },
	{ 10, 5, 2 },
	{ 0, 2, 5 },
	{ 6, 11, 3 },
	{ 6, 3, 5 },
	{ 2, 10, 3 },
	{ 10, 5, 3 },
	{ 5, 8, 9 },
	{ 5, 2, 8 },
	{ 5, 6, 2 },
	{ 3, 8, 2 },
	{ 9, 5, 6 },
	{ 9, 6, 0 },
	{ 0, 6, 2 },
	{ 1, 5, 8 },
	{ 1, 8, 0 },
	{ 5, 6, 8 },
	{ 3, 8, 2 },
	{ 6, 2, 8 },
	{ 1, 5, 6 },
	{ 2, 1, 6 },
	{ 1, 3, 6 },
	{ 1, 6, 10 },
	{ 3, 8, 6 },
	{ 5, 6, 9 },
	{ 8, 9, 6 },
	{ 10, 1, 0 },
	{ 10, 0, 6 },
	{ 9, 5, 0 },
	{ 5, 6, 0 },
	{ 0, 3, 8 },
	{ 5, 6, 10 },
	{ 10, 5, 6 },
	{ 11, 5, 10 },
	{ 7, 5, 11 },
	{ 11, 5, 10 },
	{ 11, 7, 5 },
	{ 8, 3, 0 },
	{ 5, 11, 7 },
	{ 5, 10, 11 },
	{ 1, 9, 0 },
	{ 10, 7, 5 },
	{ 10, 11, 7 },
	{ 9, 8, 1 },
	{ 8, 3, 1 },
	{ 11, 1, 2 },
	{ 11, 7, 1 },
	{ 7, 5, 1 },
	{ 0, 8, 3 },
	{ 1, 2, 7 },
	{ 1, 7, 5 },
	{ 7, 2, 11 },
	{ 9, 7, 5 },
	{ 9, 2, 7 },
	{ 9, 0, 2 },
	{ 2, 11, 7 },
	{ 7, 5, 2 },
	{ 7, 2, 11 },
	{ 5, 9, 2 },
	{ 3, 2, 8 },
	{ 9, 8, 2 },
	{ 2, 5, 10 },
	{ 2, 3, 5 },
	{ 3, 7, 5 },
	{ 8, 2, 0 },
	{ 8, 5, 2 },
	{ 8, 7, 5 },
	{ 10, 2, 5 },
	{ 9, 0, 1 },
	{ 5, 10, 3 },
	{ 5, 3, 7 },
	{ 3, 10, 2 },
	{ 9, 8, 2 },
	{ 9, 2, 1 },
	{ 8, 7, 2 },
	{ 10, 2, 5 },
	{ 7, 5, 2 },
	{ 1, 3, 5 },
	{ 3, 7, 5 },
	{ 0, 8, 7 },
	{ 0, 7, 1 },
	{ 1, 7, 5 },
	{ 9, 0, 3 },
	{ 9, 3, 5 },
	{ 5, 3, 7 },
	{ 9, 8, 7 },
	{ 5, 9, 7 },
	{ 5, 8, 4 },
	{ 5, 10, 8 },
	{ 10, 11, 8 },
	{ 5, 0, 4 },
	{ 5, 11, 0 },
	{ 5, 10, 11 },
	{ 11, 3, 0 },
	{ 0, 1, 9 },
	{ 8, 4, 10 },
	{ 8, 10, 11 },
	{ 10, 4, 5 },
	{ 10, 11, 4 },
	{ 10, 4, 5 },
	{ 11, 3, 4 },
	{ 9, 4, 1 },
	{ 3, 1, 4 },
	{ 2, 5, 1 },
	{ 2, 8, 5 },
	{ 2, 11, 8 },
	{ 4, 5, 8 },
	{ 0, 4, 11 },
	{ 0, 11, 3 },
	{ 4, 5, 11 },
	{ 2, 11, 1 },
	{ 5, 1, 11 },
	{ 0, 2, 5 },
	{ 0, 5, 9 },
	{ 2, 11, 5 },
	{ 4, 5, 8 },
	{ 11, 8, 5 },
	{ 9, 4, 5 },
	{ 2, 11, 3 },
	{ 2, 5, 10 },
	{ 3, 5, 2 },
	{ 3, 4, 5 },
	{ 3, 8, 4 },
	{ 5, 10, 2 },
	{ 5, 2, 4 },
	{ 4, 2, 0 },
	{ 3, 10, 2 },
	{ 3, 5, 10 },
	{ 3, 8, 5 },
	{ 4, 5, 8 },
	{ 0, 1, 9 },
	{ 5, 10, 2 },
	{ 5, 2, 4 },
	{ 1, 9, 2 },
	{ 9, 4, 2 },
	{ 8, 4, 5 },
	{ 8, 5, 3 },
	{ 3, 5, 1 },
	{ 0, 4, 5 },
	{ 1, 0, 5 },
	{ 8, 4, 5 },
	{ 8, 5, 3 },
	{ 9, 0, 5 },
	{ 0, 3, 5 },
	{ 9, 4, 5 },
	{ 4, 11, 7 },
	{ 4, 9, 11 },
	{ 9, 10, 11 },
	{ 0, 8, 3 },
	{ 4, 9, 7 },
	{ 9, 11, 7 },
	{ 9, 10, 11 },
	{ 1, 10, 11 },
	{ 1, 11, 4 },
	{ 1, 4, 0 },
	{ 7, 4, 11 },
	{ 3, 1, 4 },
	{ 3, 4, 8 },
	{ 1, 10, 4 },
	{ 7, 4, 11 },
	{ 10, 11, 4 },
	{ 4, 11, 7 },
	{ 9, 11, 4 },
	{ 9, 2, 11 },
	{ 9, 1, 2 },
	{ 9, 7, 4 },
	{ 9, 11, 7 },
	{ 9, 1, 11 },
	{ 2, 11, 1 },
	{ 0, 8, 3 },
	{ 11, 7, 4 },
	{ 11, 4, 2 },
	{ 2, 4, 0 },
	{ 11, 7, 4 },
	{ 11, 4, 2 },
	{ 8, 3, 4 },
	{ 3, 2, 4 },
	{ 2, 9, 10 },
	{ 2, 7, 9 },
	{ 2, 3, 7 },
	{ 7, 4, 9 },
	{ 9, 10, 7 },
	{ 9, 7, 4 },
	{ 10, 2, 7 },
	{ 8, 7, 0 },
	{ 2, 0, 7 },
	{ 3, 7, 10 },
	{ 3, 10, 2 },
	{ 7, 4, 10 },
	{ 1, 10, 0 },
	{ 4, 0, 10 },
	{ 1, 10, 2 },
	{ 8, 7, 4 },
	{ 4, 9, 1 },
	{ 4, 1, 7 },
	{ 7, 1, 3 },
	{ 4, 9, 1 },
	{ 4, 1, 7 },
	{ 0, 8, 1 },
	{ 8, 7, 1 },
	{ 4, 0, 3 },
	{ 7, 4, 3 },
	{ 4, 8, 7 },
	{ 9, 10, 8 },
	{ 10, 11, 8 },
	{ 3, 0, 9 },
	{ 3, 9, 11 },
	{ 11, 9, 10 },
	{ 0, 1, 10 },
	{ 0, 10, 8 },
	{ 8, 10, 11 },
	{ 3, 1, 10 },
	{ 11, 3, 10 },
	{ 1, 2, 11 },
	{ 1, 11, 9 },
	{ 9, 11, 8 },
	{ 3, 0, 9 },
	{ 3, 9, 11 },
	{ 1, 2, 9 },
	{ 2, 11, 9 },
	{ 0, 2, 11 },
	{ 8, 0, 11 },
	{ 3, 2, 11 },
	{ 2, 3, 8 },
	{ 2, 8, 10 },
	{ 10, 8, 9 },
	{ 9, 10, 2 },
	{ 0, 9, 2 },
	{ 2, 3, 8 },
	{ 2, 8, 10 },
	{ 0, 1, 8 },
	{ 1, 10, 8 },
	{ 1, 10, 2 },
	{ 1, 3, 8 },
	{ 9, 1, 8 },
	{ 0, 9, 1 },
	{ 0, 3, 8 },
};

ndMarchingCubes::ndEdge ndMarchingCubes::m_edges[] =
{
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 11, 3, 7 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 4, 4, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 5, 6, 5 },
	{ 6, 7, 6 },
	{ 10, 2, 6 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 5, 6, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 4, 4, 5 },
	{ 5, 6, 5 },
	{ 9, 1, 5 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 4, 4, 5 },
	{ 7, 7, 4 },
	{ 8, 0, 4 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 10, 2, 6 },
	{ 11, 3, 7 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 9, 1, 5 },
	{ 11, 3, 7 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 8, 0, 4 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 11, 3, 7 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 2, 2, 3 },
	{ 9, 1, 5 },
	{ 10, 2, 6 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 2, 2, 3 },
	{ 10, 2, 6 },
	{ 1, 1, 2 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 1, 1, 2 },
	{ 9, 1, 5 },
	{ 0, 0, 1 },
	{ 3, 3, 0 },
	{ 8, 0, 4 },
};


ndMarchingCubes::ndGridHash::ndGridHash()
{
}

ndMarchingCubes::ndGridHash::ndGridHash(const ndGridHash& src, ndInt8 cellType)
{
	m_gridFullHash = src.m_gridFullHash;
	m_cellType = cellType;
}

ndMarchingCubes::ndGridHash::ndGridHash(ndInt32 x, ndInt32 y, ndInt32 z)
{
	m_gridFullHash = 0;
	m_x = ndInt16(x);
	m_y = ndInt16(y);
	m_z = ndInt16(z);
}

ndMarchingCubes::ndGridHash::ndGridHash(const ndVector& grid)
{
	ndAssert(grid.m_x >= ndFloat32(0.0f));
	ndAssert(grid.m_y >= ndFloat32(0.0f));
	ndAssert(grid.m_z >= ndFloat32(0.0f));
	ndAssert(grid.m_x < ndFloat32(128.0f * 256.0f));
	ndAssert(grid.m_y < ndFloat32(128.0f * 256.0f));
	ndAssert(grid.m_z < ndFloat32(128.0f * 256.0f));

	ndVector hash(grid.Floor().GetInt());
	m_gridFullHash = 0;
	m_x = ndInt16(hash.m_ix);
	m_y = ndInt16(hash.m_iy);
	m_z = ndInt16(hash.m_iz);
}

ndMarchingCubes::ndMarchingCubes(ndThreadPool* const threadPool, ndFloat32 particleSize)
	:ndClassAlloc()
	,m_gridSize(particleSize)
	,m_invGridSize(ndFloat32(1.0f) / particleSize)
	,m_meshPoints()
	,m_meshNormals()
	,m_meshIndices()
	,m_threadPool(threadPool)
{
	m_gridSize = m_gridSize & ndVector::m_triplexMask;
	m_invGridSize = m_invGridSize & ndVector::m_triplexMask;
}

ndMarchingCubes::~ndMarchingCubes()
{
}

const ndArray<ndInt32>& ndMarchingCubes::GetTriangles() const
{
	return m_meshIndices;
}

const ndArray<ndVector>& ndMarchingCubes::GetMeshVertex() const
{
	return m_meshPoints;
}

const ndArray<ndVector>& ndMarchingCubes::GetMeshNormals() const
{
	return m_meshNormals;
}

// ***********************************************************
//
// ***********************************************************
ndMarchingCubesPaticles::ndMarchingCubesPaticles(ndThreadPool* const threadPool, ndFloat32 particleSize)
	:ndMarchingCubes(threadPool, particleSize)
	,m_boxP0(ndVector::m_zero)
	,m_boxP1(ndVector::m_zero)
	,m_volumeInGrids(ndVector::m_zero)
	,m_hashGridMap()
	,m_hashGridMapScratchBuffer()
	,m_cellScans()
	,m_cellTrianglesScans()
{
}

void ndMarchingCubesPaticles::CalculateAABB()
{
	ndFixSizeArray<ndVector, D_MAX_THREADS_COUNT * 2> partialAABB(m_threadPool->GetThreadCount() * 2);
	auto CalculateAABB = ndMakeObject::ndFunction([this, &partialAABB](ndInt32 groupId, ndInt32 threadIndex)
	{
		const ndVector p(m_pointParticles[groupId]);
		partialAABB[threadIndex * 2 + 0] = p.GetMin(partialAABB[threadIndex * 2 + 0]);
		partialAABB[threadIndex * 2 + 1] = p.GetMax(partialAABB[threadIndex * 2 + 1]);
	});

	for (ndInt32 i = 0; i < m_threadPool->GetThreadCount(); ++i)
	{
		partialAABB[i * 2 + 0] = ndVector(ndFloat32(1.0e10f));
		partialAABB[i * 2 + 1] = ndVector(ndFloat32(-1.0e10f));
	}
	const ndInt32 jobStride = 256;
	const ndInt32 count = ndInt32(m_pointParticles.GetCount());
	m_threadPool->ParallelExecute(CalculateAABB, count, jobStride);

	ndVector boxP0(partialAABB[0]);
	ndVector boxP1(partialAABB[1]);
	for (ndInt32 i = 1; i < m_threadPool->GetThreadCount(); ++i)
	{
		boxP0 = boxP0.GetMin(partialAABB[i * 2 + 0]);
		boxP1 = boxP1.GetMax(partialAABB[i * 2 + 1]);
	}
	boxP0 -= m_gridSize;
	boxP1 += m_gridSize;

	m_boxP0 = m_gridSize * (boxP0 * m_invGridSize).Floor();
	m_boxP1 = m_gridSize * (boxP1 * m_invGridSize).Ceiling();
}

void ndMarchingCubesPaticles::RemoveDuplicates()
{
	m_hashGridMapScratchBuffer.SetCount(m_pointParticles.GetCount());
	auto CalculateHashes = ndMakeObject::ndFunction([this](ndInt32 groupId, ndInt32)
	{
		const ndVector r(m_pointParticles[groupId] - m_boxP0);
		const ndVector p(r * m_invGridSize);
		const ndGridHash hashKey(p);
		m_hashGridMapScratchBuffer[groupId] = hashKey;
	});

	const ndInt32 jobStride = 256;
	const ndInt32 count = ndInt32(m_pointParticles.GetCount());
	m_threadPool->ParallelExecute(CalculateHashes, count, jobStride);

	m_volumeInGrids = (m_invGridSize * (m_boxP1 - m_boxP0 + m_gridSize * ndVector::m_two)).Ceiling().GetInt();
	ndCountingSort<ndGridHash, ndKey_xlow, 8>(*m_threadPool, m_hashGridMapScratchBuffer, m_hashGridMap, nullptr, nullptr);
	if (m_volumeInGrids.m_ix >= 256)
	{
		ndCountingSort<ndGridHash, ndKey_xhigh, 8>(*m_threadPool, m_hashGridMapScratchBuffer, m_hashGridMap, nullptr, nullptr);
	}

	ndCountingSort<ndGridHash, ndKey_ylow, 8>(*m_threadPool, m_hashGridMapScratchBuffer, m_hashGridMap, nullptr, nullptr);
	if (m_volumeInGrids.m_iy >= 256)
	{
		ndCountingSort<ndGridHash, ndKey_yhigh, 8>(*m_threadPool, m_hashGridMapScratchBuffer, m_hashGridMap, nullptr, nullptr);
	}

	ndCountingSort<ndGridHash, ndKey_zlow, 8>(*m_threadPool, m_hashGridMapScratchBuffer, m_hashGridMap, nullptr, nullptr);
	if (m_volumeInGrids.m_iz >= 256)
	{
		ndCountingSort<ndGridHash, ndKey_zhigh, 8>(*m_threadPool, m_hashGridMapScratchBuffer, m_hashGridMap, nullptr, nullptr);
	}

	ndInt32 gridCount = 0;
	for (ndInt32 i = 1; i < m_hashGridMapScratchBuffer.GetCount(); ++i)
	{
		const ndGridHash cell(m_hashGridMapScratchBuffer[i]);
		ndAssert(cell.m_cellType == 0);
		ndAssert(m_hashGridMapScratchBuffer[i - 1].m_cellType == 0);
		const ndInt32 uniqueGrid = (cell.m_gridFullHash != m_hashGridMapScratchBuffer[i - 1].m_gridFullHash) ? 1 : 0;
		gridCount += uniqueGrid;
		m_hashGridMapScratchBuffer[gridCount] = cell;
	}
	gridCount++;
	m_hashGridMapScratchBuffer.SetCount(gridCount);
}

void ndMarchingCubesPaticles::GenerateGrids()
{
	const ndGridHashSteps steps;
	m_hashGridMap.SetCount(m_hashGridMapScratchBuffer.GetCount() * 8);
	auto GenerateGrids = ndMakeObject::ndFunction([this, &steps](ndInt32 groupId, ndInt32)
	{
		const ndInt32 gridStartIndex = groupId;
		const ndGridHash hashKey(m_hashGridMapScratchBuffer[gridStartIndex]);
		for (ndInt32 j = 0; j < 8; ++j)
		{
			ndGridHash cell(hashKey);
			cell.m_x += steps.m_steps[j].m_x;
			cell.m_y += steps.m_steps[j].m_y;
			cell.m_z += steps.m_steps[j].m_z;
			cell.m_cellType = steps.m_cellType[j];
			ndAssert(cell.m_x <= 0x7fff);
			ndAssert(cell.m_y <= 0x7fff);
			ndAssert(cell.m_z <= 0x7fff);
			m_hashGridMap[gridStartIndex * 8 + j] = cell;
		}
	});

	const ndInt32 jobStride = 256;
	const ndInt32 count = ndInt32(m_hashGridMapScratchBuffer.GetCount());
	m_threadPool->ParallelExecute(GenerateGrids, count, jobStride);

	//class ndParticleOwners
	//{
	//	public:
	//	ndParticleOwners(void* const) {}
	//	ndInt32 GetKey(const ndGridHash& cell) const
	//	{
	//		// the last cell is the onw that own the particle
	//		// that is cell type 3
	//		return (cell.m_cellType == 3) ? 0 : 1;
	//	}
	//};
	//ndUnsigned32 cellOwnersScans[8];
	//ndCountingSort<ndGridHash, ndParticleOwners, 2>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, cellOwnersScans, nullptr);
	//m_hashGridMap.SetCount(cellOwnersScans[1]);

	ndCountingSort<ndGridHash, ndKey_xlow, 8>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, nullptr, nullptr);
	if (m_volumeInGrids.m_ix >= 256)
	{
		ndCountingSort<ndGridHash, ndKey_xhigh, 8>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, nullptr, nullptr);
	}

	ndCountingSort<ndGridHash, ndKey_ylow, 8>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, nullptr, nullptr);
	if (m_volumeInGrids.m_iy >= 256)
	{
		ndCountingSort<ndGridHash, ndKey_yhigh, 8>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, nullptr, nullptr);
	}

	ndCountingSort<ndGridHash, ndKey_zlow, 8>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, nullptr, nullptr);
	if (m_volumeInGrids.m_iz >= 256)
	{
		ndCountingSort<ndGridHash, ndKey_zhigh, 8>(*m_threadPool, m_hashGridMap, m_hashGridMapScratchBuffer, nullptr, nullptr);
	}

	ndInt32 start = 0;
	m_cellScans.SetCount(0);
	m_hashGridMap.PushBack(ndGridHash(0x7fff, 0x7fff, 0x7fff));
	for (ndInt32 i = 0; i < ndInt32(m_hashGridMap.GetCount()) - 1; ++i)
	{
		const ndGridHash hash(m_hashGridMap[i], 0);
		for (ndInt32 j = i + 1; j < ndInt32(m_hashGridMap.GetCount()); ++j)
		{
			const ndGridHash hash1(m_hashGridMap[j], 0);
			if (hash.m_gridFullHash != hash1.m_gridFullHash)
			{
				i = j;
				break;
			}
		}
		ndAssert((i - start) > 0);
		ndAssert((i - start) <= 8);
		m_cellScans.PushBack(i - start);
		start = i;
		i--;
	}
	ndAssert((ndInt32(m_hashGridMap.GetCount()) - start) > 0);
	ndAssert((ndInt32(m_hashGridMap.GetCount()) - start) <= 8);

	ndInt32 sum = 0;
	for (ndInt32 i = 0; i < ndInt32(m_cellScans.GetCount()); ++i)
	{
		ndInt32 sum1 = sum + m_cellScans[i];
		m_cellScans[i] = sum;
		sum = sum1;
	}
	m_cellScans.PushBack(sum);
	ndAssert(sum == (m_hashGridMap.GetCount() - 1));
}

void ndMarchingCubesPaticles::GenerateTriangles()
{
	auto CountTriangles = ndMakeObject::ndFunction([this](ndInt32 groupId, ndInt32)
	{
		m_cellTrianglesScans[groupId] = 0;
		const ndInt32 cellStart = m_cellScans[groupId];
		const ndInt32 cellCount = m_cellScans[groupId + 1] - cellStart;

		if (cellCount < 8)
		{
			const ndGridHash startGrid(m_hashGridMap[cellStart], 0);

			ndIsoCell cell;
			ndVector* const isoValue = &cell.m_isoValues[0];
			ndVector origin(ndFloat32(startGrid.m_x + 1), ndFloat32(startGrid.m_y + 1), ndFloat32(startGrid.m_z + 1), ndFloat32(0.0f));
			for (ndInt32 j = 0; j < 8; j++)
			{
				isoValue[j] = origin + m_gridCorners[j];
			}

			for (ndInt32 j = 0; j < cellCount; j++)
			{
				ndInt32 index = m_hashGridMap[cellStart + j].m_cellType;
				isoValue[index].m_w = ndFloat32(1.0f);
			}

			ndInt32 tableIndex = 0;
			for (ndInt32 j = 0; j < 8; ++j)
			{
				//tableIndex |= (cell.m_isoValues[j].m_w < m_isoSufaceValue) << j;
				tableIndex |= (cell.m_isoValues[j].m_w < 0.5f) << j;
			}

			const ndInt32 triangleStart = m_facesScan[tableIndex];
			const ndInt32 triangleCount = m_facesScan[tableIndex + 1] - triangleStart;
			m_cellTrianglesScans[groupId] = triangleCount;
		}
	});

	m_cellTrianglesScans.SetCount(m_cellScans.GetCount());

	const ndInt32 jobStride = 256;
	const ndInt32 count = ndInt32(m_cellScans.GetCount()) - 1;
	m_threadPool->ParallelExecute(CountTriangles, count, jobStride);

	ndInt32 sum = 0;
	for (ndInt32 i = 0; i < count; ++i)
	{
		ndInt32 sum1 = sum + m_cellTrianglesScans[i];
		m_cellTrianglesScans[i] = sum;
		sum = sum1;
	}
	m_cellTrianglesScans[count] = sum;

	m_meshPoints.SetCount(sum * 3);
	auto GenerateTriangles = ndMakeObject::ndFunction([this](ndInt32 groupId, ndInt32)
	{
		const ndInt32 triangleStart = m_cellTrianglesScans[groupId];
		const ndInt32 triangleCount = m_cellTrianglesScans[groupId + 1] - triangleStart;
		if (triangleCount)
		{
			const ndInt32 cellStart = m_cellScans[groupId];
			const ndInt32 cellCount = m_cellScans[groupId + 1] - cellStart;
			ndAssert(cellCount > 0);
			ndAssert(cellCount < 8);

			const ndGridHash startGrid(m_hashGridMap[cellStart], 0);

			ndIsoCell cell;
			ndVector* const isoValue = &cell.m_isoValues[0];
			ndVector origin(ndFloat32(startGrid.m_x + 1), ndFloat32(startGrid.m_y + 1), ndFloat32(startGrid.m_z + 1), ndFloat32(0.0f));
			for (ndInt32 i = 0; i < 8; i++)
			{
				isoValue[i] = origin + m_gridCorners[i];
			}

			for (ndInt32 i = 0; i < cellCount; i++)
			{
				ndInt32 index = m_hashGridMap[cellStart + i].m_cellType;
				isoValue[index].m_w = ndFloat32(1.0f);
			}

			ndInt32 tableIndex = 0;
			for (ndInt32 i = 0; i < 8; ++i)
			{
				//tableIndex |= (cell.m_isoValues[i].m_w < m_isoSufaceValue) << i;
				tableIndex |= (cell.m_isoValues[i].m_w < 0.5f) << i;
			}

			ndVector vertlist[12];
			const ndInt32 edgeStart = m_edgeScan[tableIndex];
			const ndInt32 edgeCount = m_edgeScan[tableIndex + 1] - edgeStart;
			for (ndInt32 i = 0; i < edgeCount; ++i)
			{
				const ndEdge& edge = m_edges[edgeStart + i];
				const ndInt32 midPoint = edge.m_midPoint;

				const ndVector p0(cell.m_isoValues[edge.m_p0]);
				const ndVector p1(cell.m_isoValues[edge.m_p1]);
				ndAssert(ndAbs(p1.m_w - p0.m_w) == ndFloat32(1.0f));
				const ndVector p1p0(p1 - p0);
				vertlist[midPoint] = ndVector::m_triplexMask & (p0 + p1p0 * ndVector::m_half);
			}

			const ndInt32 faceStart = m_facesScan[tableIndex];
			const ndInt32 triangleStartOffset = triangleStart * 3;
			for (ndInt32 i = 0; i < triangleCount; ++i)
			{
				const ndInt32 j = i * 3;
				const ndInt32 j0 = m_faces[faceStart + i][0];
				const ndInt32 j2 = m_faces[faceStart + i][1];
				const ndInt32 j1 = m_faces[faceStart + i][2];

				m_meshPoints[triangleStartOffset + j + 0] = vertlist[j0];
				m_meshPoints[triangleStartOffset + j + 1] = vertlist[j1];
				m_meshPoints[triangleStartOffset + j + 2] = vertlist[j2];

				m_meshPoints[triangleStartOffset + j + 0].m_w = ndFloat32(triangleStartOffset + j + 0);
				m_meshPoints[triangleStartOffset + j + 1].m_w = ndFloat32(triangleStartOffset + j + 1);
				m_meshPoints[triangleStartOffset + j + 2].m_w = ndFloat32(triangleStartOffset + j + 2);
			}

#if 0
			{
				Original::GRIDCELL grid;
				for (ndInt32 i = 0; i < 8; i++)
				{
					grid.p[i].x = isoValue[i].m_x;
					grid.p[i].y = isoValue[i].m_y;
					grid.p[i].z = isoValue[i].m_z;
					grid.val[i] = isoValue[i].m_w;
				}
				Original::TRIANGLE triangles[8];
				ndInt32 originalCount = Original::Polygonise(grid, 0.5f, &triangles[0]);
				ndAssert(originalCount == triangleCount);
				for (ndInt32 i = 0; i < originalCount; ++i)
				{
					Original::TRIANGLE tr = triangles[i];
					for (ndInt32 j = 0; j < 3; ++j)
					{
						ndVector q(tr.p[j].x, tr.p[j].y, tr.p[j].z, ndFloat32(0.0f));
						ndVector p(m_meshPoints[triangleStartOffset + i * 3 + j + 0]);
						ndVector error(p - q);
						ndAssert(error.m_x == ndFloat32(0.0f));
						ndAssert(error.m_y == ndFloat32(0.0f));
						ndAssert(error.m_z == ndFloat32(0.0f));
					}
				}
			}
#endif
		}
	});
	m_threadPool->ParallelExecute(GenerateTriangles, count, jobStride);
}

void ndMarchingCubesPaticles::GenerateIndexList()
{
	#define D_LOW_RES_BITS	   1
	#define D_LOW_RES_FRACTION (1 << D_LOW_RES_BITS)

	class ndKey_lowX
	{
		public:
		ndKey_lowX(void* const) {}
		ndInt32 GetKey(const ndVector& point) const
		{
			ndFloat32 val = (point.m_x * D_LOW_RES_FRACTION);
			ndInt32 key = ndInt32(val);
			return key & 0xff;
		}
	};

	class ndKey_highX
	{
		public:
		ndKey_highX(void* const) {}
		ndInt32 GetKey(const ndVector& point) const
		{
			ndFloat32 val = point.m_x * ndFloat32(D_LOW_RES_FRACTION);
			ndInt32 key = ndInt32(val) >> 8;
			return key & 0xff;
		}
	};

	class ndKey_lowY
	{
		public:
		ndKey_lowY(void* const) {}
		ndInt32 GetKey(const ndVector& point) const
		{
			ndFloat32 val = (point.m_y * D_LOW_RES_FRACTION);
			ndInt32 key = ndInt32(val);
			return key & 0xff;
		}
	};

	class ndKey_highY
	{
		public:
		ndKey_highY(void* const) {}
		ndInt32 GetKey(const ndVector& point) const
		{
			ndFloat32 val = point.m_y * ndFloat32(D_LOW_RES_FRACTION);
			ndInt32 key = ndInt32(val) >> 8;
			return key & 0xff;
		}
	};

	class ndKey_lowZ
	{
		public:
		ndKey_lowZ(void* const) {}
		ndInt32 GetKey(const ndVector& point) const
		{
			ndFloat32 val = (point.m_z * D_LOW_RES_FRACTION);
			ndInt32 key = ndInt32(val);
			return key & 0xff;
		}
	};

	class ndKey_highZ
	{
		public:
		ndKey_highZ(void* const) {}
		ndInt32 GetKey(const ndVector& point) const
		{
			ndFloat32 val = point.m_z * ndFloat32(D_LOW_RES_FRACTION);
			ndInt32 key = ndInt32(val) >> 8;
			return key & 0xff;
		}
	};

	ndCountingSort<ndVector, ndKey_lowX, 8>(*m_threadPool, m_meshPoints, m_meshNormals, nullptr, nullptr);
	if (D_LOW_RES_FRACTION * m_volumeInGrids.m_ix >= 256)
	{
		ndCountingSort<ndVector, ndKey_highX, 8>(*m_threadPool, m_meshPoints, m_meshNormals, nullptr, nullptr);
	}

	ndCountingSort<ndVector, ndKey_lowY, 8>(*m_threadPool, m_meshPoints, m_meshNormals, nullptr, nullptr);
	if (D_LOW_RES_FRACTION * m_volumeInGrids.m_iy >= 256)
	{
		ndCountingSort<ndVector, ndKey_highY, 8>(*m_threadPool, m_meshPoints, m_meshNormals, nullptr, nullptr);
	}

	ndCountingSort<ndVector, ndKey_lowZ, 8>(*m_threadPool, m_meshPoints, m_meshNormals, nullptr, nullptr);
	if (D_LOW_RES_FRACTION * m_volumeInGrids.m_iz >= 256)
	{
		ndCountingSort<ndVector, ndKey_highZ, 8>(*m_threadPool, m_meshPoints, m_meshNormals, nullptr, nullptr);
	}
	m_meshIndices.SetCount(m_meshPoints.GetCount());

	ndInt32 vertexCount = 0;
	m_meshPoints.PushBack(m_boxP1);
	for (ndInt32 i = 0; i < ndInt32(m_meshPoints.GetCount()) - 1; ++i)
	{
		const ndInt32 index = ndInt32(m_meshPoints[i].m_w);
		m_meshIndices[index] = vertexCount;
		m_meshPoints[vertexCount] = m_meshPoints[i] & ndVector::m_triplexMask;

		const ndGridHash hash(m_meshPoints[i] * ndVector::m_two, 0);
		for (i = i + 1; i < ndInt32(m_meshPoints.GetCount()); ++i)
		{
			const ndGridHash hash1(m_meshPoints[i] * ndVector::m_two, 0);
			if (hash.m_gridFullHash != hash1.m_gridFullHash)
			{
				break;
			}
			const ndInt32 duplicateIndex = ndInt32(m_meshPoints[i].m_w);
			m_meshIndices[duplicateIndex] = vertexCount;
		}
		--i;
		vertexCount++;
	}
	m_meshPoints.SetCount(vertexCount);
	m_meshNormals.SetCount(vertexCount);

	// transform to world space
	auto ApplyScale = ndMakeObject::ndFunction([this](ndInt32 groupId, ndInt32)
	{
		m_meshNormals[groupId] = ndVector::m_zero;
		m_meshPoints[groupId] = m_meshPoints[groupId] * m_gridSize + m_boxP0;
	});

	const ndInt32 jobStride = 256;
	const ndInt32 count = ndInt32(m_meshPoints.GetCount());
	m_threadPool->ParallelExecute(ApplyScale, count, jobStride);

	auto CalculateVertexNormals = ndMakeObject::ndFunction([this](ndInt32 groupId, ndInt32)
	{
		const ndInt32 index = groupId * 3;
		const ndInt32 id0 = m_meshIndices[index + 0];
		const ndInt32 id1 = m_meshIndices[index + 1];
		const ndInt32 id2 = m_meshIndices[index + 2];

		const ndVector p0(m_meshPoints[id0]);
		const ndVector p1(m_meshPoints[id1]);
		const ndVector p2(m_meshPoints[id2]);

		const ndVector e_10(p1 - p0);
		const ndVector e_20(p2 - p0);
		const ndVector normal(e_10.CrossProduct(e_20) & ndVector::m_triplexMask);
		m_meshNormals[id0] += normal;
		m_meshNormals[id1] += normal;
		m_meshNormals[id2] += normal;
	});

	const ndInt32 triangleCount = ndInt32(m_meshIndices.GetCount()) / 3;
	// need to build an edge list to parallelize this,
	// for now just add the contributions 
	//m_threadPool->ParallelExecute(CalculateVertexNormals, triangleCount, jobStride);
	for (ndInt32 i = 0; i < triangleCount; ++i)
	{
		CalculateVertexNormals(i, 0);
	}

	// Normalize normals.
	for (ndInt32 i = 0; i < vertexCount; i++)
	{
		m_meshNormals[i] = m_meshNormals[i].Normalize();
	}
}

void ndMarchingCubesPaticles::GenerateMesh()
{
	CalculateAABB();
	RemoveDuplicates();
	GenerateGrids();
	GenerateTriangles();
	GenerateIndexList();

	m_cellScans.SetCount(0);
	m_hashGridMap.SetCount(0);
	m_cellTrianglesScans.SetCount(0);
	m_hashGridMapScratchBuffer.SetCount(0);
}